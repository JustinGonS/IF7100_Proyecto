{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{io}from\"socket.io-client\";import{getStorage,ref,uploadBytes,getDownloadURL}from\"firebase/storage\";import{app}from\"../firebase\";// Asegúrate de importar 'app' desde 'firebase.js'\n// Conexión con Firebase Storage\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const storage=getStorage(app);// Conexión con Socket.io\nconst socket=io(\"http://localhost:3001\");const Mensajes=()=>{const[message,setMessage]=useState(\"\");const[messages,setMessages]=useState([]);const[file,setFile]=useState(null);useEffect(()=>{socket.on(\"chat message\",data=>{setMessages(prevMessages=>[...prevMessages,data]);});return()=>socket.off(\"chat message\");},[]);const sendMessage=async()=>{const messageData={message,image:null};if(file){const fileRef=ref(storage,\"images/\"+file.name);await uploadBytes(fileRef,file);const imageUrl=await getDownloadURL(fileRef);messageData.image=imageUrl;}socket.emit(\"chat message\",messageData);setMessage(\"\");setFile(null);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Mensajes\"}),/*#__PURE__*/_jsx(\"div\",{children:messages.map((msg,index)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:msg.message}),msg.image&&/*#__PURE__*/_jsx(\"img\",{src:msg.image,alt:\"uploaded\",width:\"100\"})]},index))}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:message,onChange:e=>setMessage(e.target.value),placeholder:\"Escribe un mensaje\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:e=>setFile(e.target.files[0])}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,children:\"Enviar\"})]});};export default Mensajes;","map":{"version":3,"names":["React","useState","useEffect","io","getStorage","ref","uploadBytes","getDownloadURL","app","jsx","_jsx","jsxs","_jsxs","storage","socket","Mensajes","message","setMessage","messages","setMessages","file","setFile","on","data","prevMessages","off","sendMessage","messageData","image","fileRef","name","imageUrl","emit","children","map","msg","index","src","alt","width","type","value","onChange","e","target","placeholder","files","onClick"],"sources":["C:/Users/Admin/Downloads/Proyecto_Ingeneria/cotizaciones-app/client/src/pages/Mensajes.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nimport { getStorage, ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\r\nimport { app } from \"../firebase\";  // Asegúrate de importar 'app' desde 'firebase.js'\r\n\r\n// Conexión con Firebase Storage\r\nconst storage = getStorage(app);\r\n\r\n// Conexión con Socket.io\r\nconst socket = io(\"http://localhost:3001\");\r\n\r\nconst Mensajes = () => {\r\n  const [message, setMessage] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n  const [file, setFile] = useState(null);\r\n\r\n  useEffect(() => {\r\n    socket.on(\"chat message\", (data) => {\r\n      setMessages((prevMessages) => [...prevMessages, data]);\r\n    });\r\n\r\n    return () => socket.off(\"chat message\");\r\n  }, []);\r\n\r\n  const sendMessage = async () => {\r\n    const messageData = { message, image: null };\r\n\r\n    if (file) {\r\n      const fileRef = ref(storage, \"images/\" + file.name);\r\n      await uploadBytes(fileRef, file);\r\n      const imageUrl = await getDownloadURL(fileRef);\r\n      messageData.image = imageUrl;\r\n    }\r\n\r\n    socket.emit(\"chat message\", messageData);\r\n    setMessage(\"\");\r\n    setFile(null);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1>Mensajes</h1>\r\n      <div>\r\n        {messages.map((msg, index) => (\r\n          <div key={index}>\r\n            <p>{msg.message}</p>\r\n            {msg.image && <img src={msg.image} alt=\"uploaded\" width=\"100\" />}\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <input\r\n        type=\"text\"\r\n        value={message}\r\n        onChange={(e) => setMessage(e.target.value)}\r\n        placeholder=\"Escribe un mensaje\"\r\n      />\r\n      <input\r\n        type=\"file\"\r\n        onChange={(e) => setFile(e.target.files[0])}\r\n      />\r\n      <button onClick={sendMessage}>Enviar</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Mensajes;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}